
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>05: Neutral Atom Simulator (Worked Solution) &#8212; ASQSQIS Tutorials with QuTiP</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="00: Introduction to QuTiP" href="../tutorials/00-qutip-intro.html" />
    <link rel="prev" title="04: Neutral Atom Simulator Class (Exploration)" href="04-neutral-atom-simulator-exploration.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ASQSQIS Tutorials with QuTiP</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Overview
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../student-tutorials/00-qutip-intro.html">
   00: Introduction to QuTiP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-tutorials/01-qutip-qip-i.html">
   01: Quantum Information Processing in QuTiP I
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-tutorials/02-qutip-qip-ii.html">
   02: Quantum Information Processing in QuTiP II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-tutorials/03-qutip-jcm-i.html">
   03: Jaynes-Cummings Model and the Rotating Wave Approximation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-tutorials/04-qutip-jcm-ii.html">
   04: Adding dissipation to the Jaynes-Cummings model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../student-tutorials/05-qutip-jcm-iii.html">
   05: Jaynes-Cummings Ultra-strong Coupling
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Capstone
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="00-introduction.html">
   Capstone project: Simulating a Neutral Atom Quantum Device
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01-neutral-atom-devices.html">
   01: Neutral Atom Devices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02-a-single-atom.html">
   02: A Single Atom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03-neutral-atom-simulator.html">
   03: Neutral Atom Simulator (Outline)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04-neutral-atom-simulator-exploration.html">
   04: Neutral Atom Simulator Class (Exploration)
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   05: Neutral Atom Simulator (Worked Solution)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Worked solutions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/00-qutip-intro.html">
   00: Introduction to QuTiP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/01-qutip-qip-i.html">
   01: Quantum Information Processing in QuTiP I
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/02-qutip-qip-ii.html">
   02: Quantum Information Processing in QuTiP II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/03-qutip-jcm-i.html">
   03: Jaynes-Cummings Model and the Rotating Wave Approximation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/04-qutip-jcm-ii.html">
   04: Adding dissipation to the Jaynes-Cummings model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/05-qutip-jcm-iii.html">
   05: Jaynes-Cummings Ultra-strong Coupling
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Backmatter
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../build-stats.html">
   Build information
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/hodgestar/qutip-asqsqis-2022/master?urlpath=tree/tutbok/capstone/05-neutral-atom-simulator-worked-solution.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/hodgestar/qutip-asqsqis-2022"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/hodgestar/qutip-asqsqis-2022/issues/new?title=Issue%20on%20page%20%2Fcapstone/05-neutral-atom-simulator-worked-solution.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/capstone/05-neutral-atom-simulator-worked-solution.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../_sources/capstone/05-neutral-atom-simulator-worked-solution.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#helper-functions">
   Helper functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation">
   Implementation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-circuits">
   Example circuits
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1-pretty-sequence-of-rotations-qubit-0">
     Example 1: Pretty sequence of rotations (qubit 0)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-2-pretty-sequence-of-rotations-qubit-1">
     Example 2: Pretty sequence of rotations (qubit 1)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-3-combine-the-previous-two-circuits">
     Example 3: Combine the previous two circuits
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-4-hadamard-gate-qubit-0">
     Example 4: Hadamard gate (qubit 0)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-5-cz-gate-control-qubit-0-target-qubit-1">
     Example 5: CZ gate (control qubit 0, target qubit 1)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-6-cnot-gate-control-qubit-0-target-qubit-1">
     Example 6: CNOT gate (control qubit 0, target qubit 1)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-7-prepare-a-bell-state">
     Example 7: Prepare a Bell state
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>05: Neutral Atom Simulator (Worked Solution)</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#helper-functions">
   Helper functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation">
   Implementation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-circuits">
   Example circuits
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1-pretty-sequence-of-rotations-qubit-0">
     Example 1: Pretty sequence of rotations (qubit 0)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-2-pretty-sequence-of-rotations-qubit-1">
     Example 2: Pretty sequence of rotations (qubit 1)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-3-combine-the-previous-two-circuits">
     Example 3: Combine the previous two circuits
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-4-hadamard-gate-qubit-0">
     Example 4: Hadamard gate (qubit 0)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-5-cz-gate-control-qubit-0-target-qubit-1">
     Example 5: CZ gate (control qubit 0, target qubit 1)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-6-cnot-gate-control-qubit-0-target-qubit-1">
     Example 6: CNOT gate (control qubit 0, target qubit 1)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-7-prepare-a-bell-state">
     Example 7: Prepare a Bell state
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="neutral-atom-simulator-worked-solution">
<h1>05: Neutral Atom Simulator (Worked Solution)<a class="headerlink" href="#neutral-atom-simulator-worked-solution" title="Permalink to this headline">#</a></h1>
<p>This is one possible way to implement a simple circuit simulator for an array of neutral atoms. It is not the only way or even necessarily “the best way”.</p>
<p>The implementation is intended to be simple and readable, while still implementing a set of universal gates.</p>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">qutip</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="helper-functions">
<h2>Helper functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">computational_basis_blochs</span></code> function makes plotting the outcomes of circuits more convenient. It is not part of the simulator, but it is very useful. It keeps the notebook cells readable, and allows one to focus on the task at hand, rather than worrying about the details of sub-tasks like plotting.</p>
<p>Note that one cannot represent the complete state of N-qubits or N-qutrits on N Bloch spheres – separating the state loses information about entanglement between them. Also note that the fully mixed state for one qubit (i.e. a 50/50 mixture of the |0&gt; and |1&gt; states) is rendered at the origin of the Bloch sphere.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">computational_basis_blochs</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">view</span><span class="o">=</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">30</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Render each qutrit separately on a Bloch sphere, showing only the computational basis states,</span>
<span class="sd">        i.e. the states |0&gt; and |1&gt;, tracing out the Rydberg interaction state |2&gt;.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        states : list of Qobj, or a single Qobj</span>
<span class="sd">            The N-qutrit states to display. Each qutrit is plotted separately on the Bloch sphere</span>
<span class="sd">            by first tracing out the others and then dropping the parts of the density matrix that</span>
<span class="sd">            depend on the |2&gt; state.</span>
<span class="sd">            </span>
<span class="sd">        colors : list or str of colors, default &quot;r&quot;</span>
<span class="sd">            Specifies the color to use when displaying each of the N-qutrits. If the number of qutrits</span>
<span class="sd">            is greater than the number of colors, the function cycles through the list of colors. The</span>
<span class="sd">            default, &quot;r&quot;, shows all qutrits in red.</span>
<span class="sd">            </span>
<span class="sd">        view : tuple of two floats, default (60, 30)</span>
<span class="sd">            The angle to view the bloch sphere from.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">Bloch</span><span class="p">()</span>
    <span class="n">b</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">vector_color</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">qutip</span><span class="o">.</span><span class="n">Qobj</span><span class="p">):</span>
        <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="n">states</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">states</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)]</span>
            <span class="n">b</span><span class="o">.</span><span class="n">vector_color</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">c</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">))):</span>
                <span class="n">rho_qutrit_i</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">ptrace</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">rho_qubit_i</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">Qobj</span><span class="p">(</span><span class="n">rho_qutrit_i</span><span class="o">.</span><span class="n">full</span><span class="p">()[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
                <span class="n">b</span><span class="o">.</span><span class="n">add_states</span><span class="p">(</span><span class="n">rho_qubit_i</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">#</a></h2>
<p>We implement the simulator as a single class. This keeps the implementation all neatly in one place.</p>
<p>Here is an overview of the methods of the class to help in understanding it:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">__init__</span></code>:</p>
<p>This sets up various constants, such as the qutrit basis elements, the qubit Pauli operators, the Rydberg
interaction Hamiltonian, the solver options. It also sets up an empty list of pulses and initializes the
end time of the last pulse, <code class="docutils literal notranslate"><span class="pre">t</span></code>, to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">state</span></code>:</p>
<p>A convenience function that returns a system state based on a string describing the state of each qubit. For
example, <code class="docutils literal notranslate"><span class="pre">circuit.state(&quot;01&quot;)</span></code> returns <code class="docutils literal notranslate"><span class="pre">|0&gt;</span> <span class="pre">⊗</span> <span class="pre">|1&gt;</span></code>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">_place_op</span></code>:</p>
<p>Expands an operator on a single atom to an operator on the full state of all atoms, but tensoring the
operation with appropriate copies of the identity. For example, <code class="docutils literal notranslate"><span class="pre">_place_op(1,</span> <span class="pre">op)</span></code> returns <code class="docutils literal notranslate"><span class="pre">I</span> <span class="pre">⊗</span> <span class="pre">op</span></code>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">_add_pulse</span></code>:</p>
<p>Adds a new pulse to the list of pulses, starting at the end of the last pulses, i.e. <code class="docutils literal notranslate"><span class="pre">self.t</span></code>, and lasting
for duration <code class="docutils literal notranslate"><span class="pre">dt</span></code>. The list of pulses is added to the constant Hamiltonian when the circuit is run.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">rx</span></code>, <code class="docutils literal notranslate"><span class="pre">ry</span></code>, <code class="docutils literal notranslate"><span class="pre">rz</span></code>, <code class="docutils literal notranslate"><span class="pre">h</span></code>:</p>
<p>Implementations of the single qubit gates. Each of these adds a list of pulses that act on the specified
qubit / atom.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">cz</span></code>, <code class="docutils literal notranslate"><span class="pre">cnot</span></code>:</p>
<p>Implementations of the two qubit gates. These add pulses that act on each of the two qubits, but also
rely on the Rydberg interaction defined by the constant part of the Hamiltonian for the blockade interaction
between the two qubits. Note that if the atoms are too far apart, there will be no Rydberg interaction and
these two qubit gates will not function as expected!</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">run</span></code>:</p>
<p>Run the circut and return the results from the QuTiP solver. By default it uses a <code class="docutils literal notranslate"><span class="pre">tlist</span></code> of <code class="docutils literal notranslate"><span class="pre">range(0,</span> <span class="pre">t,</span> <span class="pre">t</span> <span class="pre">*</span> <span class="pre">20)</span></code>
where <code class="docutils literal notranslate"><span class="pre">t</span></code> is the end of the last pulse, but one may specify a custom <code class="docutils literal notranslate"><span class="pre">tlist</span></code> or adjust the factor of <code class="docutils literal notranslate"><span class="pre">20</span></code>
by changing <code class="docutils literal notranslate"><span class="pre">step_rate</span></code>.</p>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">NeutralAtomCircuit</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; A neutral atom circuit laser pulse simulator.</span>
<span class="sd">    </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        atoms : ndarray or list of (x, y) coordinate tuples</span>
<span class="sd">            The 2-D coordinates of each neutral atom. For example, [(1, 0), (0, 1)]. The co-ordinates</span>
<span class="sd">            are used to calculate the Rydberg coupling coefficient -- i.e. 1 / R**6 where R is the</span>
<span class="sd">            distance between atoms. Distances ~1 give strong coupling. Distances &gt;&gt; 1 give very weak couplings. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># calculate pair-wise distances and couplings:</span>
        <span class="c1"># The actual value of C^6 is 862690 * 2 * np.pi (in units of MHz * μm^6) but that makes solving</span>
        <span class="c1"># for the dynamics slow, so we use something a bit less:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_c6</span> <span class="o">=</span> <span class="mi">10_000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_r_distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_r_couplings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_r_distances</span><span class="p">)</span>
        <span class="n">non_zero</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_r_distances</span> <span class="o">!=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_r_couplings</span><span class="p">[</span><span class="n">non_zero</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c6</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_r_distances</span><span class="p">[</span><span class="n">non_zero</span><span class="p">]</span> <span class="o">**</span> <span class="mi">6</span><span class="p">)</span>

        <span class="c1"># qutrit basis elements:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># qutrit pauli matrixes on the computation basis, i.e. ab:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ab_sx</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ab_sy</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">b</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ab_sz</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span>

        <span class="c1"># qutrit sigmax matrix for the |a&gt;, |r&gt; basis:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ar_sx</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">r</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span>

        <span class="c1"># qutrit rydberg state occupation operator:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rr</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">r</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span>
        
        <span class="c1"># construct the time-independent part of the Hamiltonian (i.e. the Rydberg interactions):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">H_rydberg</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">Qobj</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="p">[[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rr</span> <span class="o">=</span> <span class="n">rr</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_place_op</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rr</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">H_rydberg</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_r_couplings</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">rr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">rr</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                
        <span class="c1"># solver options:</span>
        <span class="c1">#</span>
        <span class="c1"># setting a large nsteps just tells the solver we&#39;re happy for solving each timestep to take a long time</span>
        <span class="c1"># setting max_step to less than the length of a pulse is extremely important -- if we don&#39;t the solver</span>
        <span class="c1">#   may skip a pulse entirely.</span>
        <span class="n">max_rydberg_eigenvalue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">H_rydberg</span><span class="o">.</span><span class="n">eigenenergies</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="n">eigvals</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">max_step</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># fraction of default pulse dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">Options</span><span class="p">(</span>
            <span class="n">nsteps</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">max_rydberg_eigenvalue</span> <span class="o">*</span> <span class="n">max_step</span><span class="p">,</span> <span class="mi">10_000</span><span class="p">),</span>
            <span class="n">max_step</span><span class="o">=</span><span class="n">max_step</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Return a ket corresponding to the given string description. For</span>
<span class="sd">            example, `.state(&quot;01&quot;)` returns `|0&gt; ⊗ |1&gt;`. The characters supported are &quot;0&quot;, &quot;1&quot;, &quot;+&quot; and &quot;-&quot;,</span>
<span class="sd">            and each represents the expected corresponding basis element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">states</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
                <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a</span>
            <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
                <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_b</span>
            <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;+&quot;</span><span class="p">:</span>
                <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_b</span>
            <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
                <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_b</span>
            <span class="n">states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">unit</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">qutip</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_place_op</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">op</span><span class="p">):</span>
        <span class="n">ops</span> <span class="o">=</span> <span class="p">[</span><span class="n">qutip</span><span class="o">.</span><span class="n">qeye</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>
        <span class="n">ops</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">op</span>
        <span class="k">return</span> <span class="n">qutip</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">ops</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_pulse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
        <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">end</span>
        <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">end</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">op</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">rx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Add a laser pulse that rotates qubit i an angle theta around the X axis. &quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">/</span> <span class="n">dt</span>
        <span class="n">O</span> <span class="o">=</span> <span class="n">v</span>
        <span class="n">op</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_place_op</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">O</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ab_sx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_pulse</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Add a laser pulse that rotates qubit i an angle theta around the Y axis. &quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">/</span> <span class="n">dt</span>
        <span class="n">O</span> <span class="o">=</span> <span class="n">v</span>
        <span class="n">op</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_place_op</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">O</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ab_sy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_pulse</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">rz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Add a laser pulse that rotates qubit i an angle theta around the Z axis. &quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">/</span> <span class="n">dt</span>
        <span class="n">O</span> <span class="o">=</span> <span class="n">v</span>
        <span class="n">op</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_place_op</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">O</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ab_sz</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_pulse</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Apply a hadamard gate to qubit i. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Add pulses that perform a controlled-Z phase flip operation on two qubits, assuming the</span>
<span class="sd">            atoms are close enough for the Rydberg blockade to prevent both atoms entering the |r&gt; state</span>
<span class="sd">            simultaneously.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">v_c</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">dt</span>
        <span class="n">O_c</span> <span class="o">=</span> <span class="n">v_c</span>
        <span class="n">v_t</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">dt</span>
        <span class="n">O_t</span> <span class="o">=</span> <span class="n">v_t</span>

        <span class="n">op1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_place_op</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">O_c</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ar_sx</span><span class="p">)</span>  <span class="c1"># pi sx rotation from a -&gt; r on control</span>
        <span class="n">op2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_place_op</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">O_t</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ar_sx</span><span class="p">)</span>  <span class="c1"># 2pi sx rotation from a -&gt; r on target</span>
        <span class="n">op3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_place_op</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">O_c</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ar_sx</span><span class="p">)</span>  <span class="c1"># pi sx rotation from a -&gt; r on control</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_add_pulse</span><span class="p">(</span><span class="n">op1</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_pulse</span><span class="p">(</span><span class="n">op2</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_pulse</span><span class="p">(</span><span class="n">op3</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cnot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Apply a CNOT gate to a control and target qubit. &quot;&quot;&quot;</span>
        <span class="c1"># CNOT = (I ⊗ H) CZ (I ⊗ H)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cz</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">tlist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step_rate</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Run the circuit. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">psi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">*</span> <span class="n">step_rate</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">:</span>
            <span class="n">H</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">QobjEvo</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">H_rydberg</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pulses</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">H</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">qeye</span><span class="p">([</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">sesolve</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">tlist</span><span class="o">=</span><span class="n">tlist</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-circuits">
<h2>Example circuits<a class="headerlink" href="#example-circuits" title="Permalink to this headline">#</a></h2>
<section id="example-1-pretty-sequence-of-rotations-qubit-0">
<h3>Example 1: Pretty sequence of rotations (qubit 0)<a class="headerlink" href="#example-1-pretty-sequence-of-rotations-qubit-0" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example 1: Pretty sequence of rotations (qubit 0)</span>

<span class="n">atoms</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)]</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">NeutralAtomCircuit</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>

<span class="n">circuit</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;00&quot;</span><span class="p">,</span> <span class="n">step_rate</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Show one Bloch sphere with initial and final states and </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Duration of circuit (t):&quot;</span><span class="p">,</span> <span class="n">circuit</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of pulses:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">pulses</span><span class="p">))</span>
<span class="n">computational_basis_blochs</span><span class="p">([</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
<span class="n">computational_basis_blochs</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Duration of circuit (t): 3
Number of pulses: 3
</pre></div>
</div>
<img alt="../_images/05-neutral-atom-simulator-worked-solution_11_1.png" src="../_images/05-neutral-atom-simulator-worked-solution_11_1.png" />
<img alt="../_images/05-neutral-atom-simulator-worked-solution_11_2.png" src="../_images/05-neutral-atom-simulator-worked-solution_11_2.png" />
</div>
</div>
</section>
<section id="example-2-pretty-sequence-of-rotations-qubit-1">
<h3>Example 2: Pretty sequence of rotations (qubit 1)<a class="headerlink" href="#example-2-pretty-sequence-of-rotations-qubit-1" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example 2: Pretty sequence of rotations (qubit 1)</span>

<span class="n">atoms</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)]</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">NeutralAtomCircuit</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>

<span class="n">circuit</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;00&quot;</span><span class="p">,</span> <span class="n">step_rate</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Show one Bloch sphere with initial and final states and</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Duration of circuit (t):&quot;</span><span class="p">,</span> <span class="n">circuit</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of pulses:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">pulses</span><span class="p">))</span>
<span class="n">computational_basis_blochs</span><span class="p">([</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
<span class="n">computational_basis_blochs</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Duration of circuit (t): 3
Number of pulses: 3
</pre></div>
</div>
<img alt="../_images/05-neutral-atom-simulator-worked-solution_13_1.png" src="../_images/05-neutral-atom-simulator-worked-solution_13_1.png" />
<img alt="../_images/05-neutral-atom-simulator-worked-solution_13_2.png" src="../_images/05-neutral-atom-simulator-worked-solution_13_2.png" />
</div>
</div>
</section>
<section id="example-3-combine-the-previous-two-circuits">
<h3>Example 3: Combine the previous two circuits<a class="headerlink" href="#example-3-combine-the-previous-two-circuits" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example 3: Pretty sequence of rotations (qubit 0 &amp; 1)</span>

<span class="n">atoms</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)]</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">NeutralAtomCircuit</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>

<span class="n">circuit</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">circuit</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;00&quot;</span><span class="p">,</span> <span class="n">step_rate</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Show one Bloch sphere with initial and final states and</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Duration of circuit (t):&quot;</span><span class="p">,</span> <span class="n">circuit</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of pulses:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">pulses</span><span class="p">))</span>
<span class="n">computational_basis_blochs</span><span class="p">([</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
<span class="n">computational_basis_blochs</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Duration of circuit (t): 6
Number of pulses: 6
</pre></div>
</div>
<img alt="../_images/05-neutral-atom-simulator-worked-solution_15_1.png" src="../_images/05-neutral-atom-simulator-worked-solution_15_1.png" />
<img alt="../_images/05-neutral-atom-simulator-worked-solution_15_2.png" src="../_images/05-neutral-atom-simulator-worked-solution_15_2.png" />
</div>
</div>
</section>
<section id="example-4-hadamard-gate-qubit-0">
<h3>Example 4: Hadamard gate (qubit 0)<a class="headerlink" href="#example-4-hadamard-gate-qubit-0" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example 4: Hadamard gate (qubit 0)</span>

<span class="n">atoms</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)]</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">NeutralAtomCircuit</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>

<span class="c1"># H = Rx(pi) Ry(pi / 2):</span>

<span class="n">circuit</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;00&quot;</span><span class="p">,</span> <span class="n">step_rate</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Show one Bloch sphere with initial and final states and</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Duration of circuit (t):&quot;</span><span class="p">,</span> <span class="n">circuit</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of pulses:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">pulses</span><span class="p">))</span>
<span class="n">computational_basis_blochs</span><span class="p">([</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
<span class="n">computational_basis_blochs</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Duration of circuit (t): 2
Number of pulses: 2
</pre></div>
</div>
<img alt="../_images/05-neutral-atom-simulator-worked-solution_17_1.png" src="../_images/05-neutral-atom-simulator-worked-solution_17_1.png" />
<img alt="../_images/05-neutral-atom-simulator-worked-solution_17_2.png" src="../_images/05-neutral-atom-simulator-worked-solution_17_2.png" />
</div>
</div>
</section>
<section id="example-5-cz-gate-control-qubit-0-target-qubit-1">
<h3>Example 5: CZ gate (control qubit 0, target qubit 1)<a class="headerlink" href="#example-5-cz-gate-control-qubit-0-target-qubit-1" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example 5: CZ gate (control qubit 0, target qubit 1)</span>

<span class="n">atoms</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)]</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">NeutralAtomCircuit</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>

<span class="n">circuit</span><span class="o">.</span><span class="n">cz</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;0+&quot;</span><span class="p">,</span> <span class="n">step_rate</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Show one Bloch sphere with initial and final states and</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Duration of circuit (t):&quot;</span><span class="p">,</span> <span class="n">circuit</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of pulses:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">pulses</span><span class="p">))</span>
<span class="n">computational_basis_blochs</span><span class="p">([</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
<span class="n">computational_basis_blochs</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Duration of circuit (t): 3
Number of pulses: 3
</pre></div>
</div>
<img alt="../_images/05-neutral-atom-simulator-worked-solution_19_1.png" src="../_images/05-neutral-atom-simulator-worked-solution_19_1.png" />
<img alt="../_images/05-neutral-atom-simulator-worked-solution_19_2.png" src="../_images/05-neutral-atom-simulator-worked-solution_19_2.png" />
</div>
</div>
</section>
<section id="example-6-cnot-gate-control-qubit-0-target-qubit-1">
<h3>Example 6: CNOT gate (control qubit 0, target qubit 1)<a class="headerlink" href="#example-6-cnot-gate-control-qubit-0-target-qubit-1" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example 6: CNOT gate (control qubit 0, target qubit 1)</span>

<span class="n">atoms</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)]</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">NeutralAtomCircuit</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>

<span class="c1"># CNOT = (I ⊗ H) CZ (I ⊗ H):</span>

<span class="n">circuit</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">cz</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="n">step_rate</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Show one Bloch sphere with initial and final states and</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Duration of circuit (t):&quot;</span><span class="p">,</span> <span class="n">circuit</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of pulses:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">pulses</span><span class="p">))</span>
<span class="n">computational_basis_blochs</span><span class="p">([</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
<span class="n">computational_basis_blochs</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Duration of circuit (t): 7
Number of pulses: 7
</pre></div>
</div>
<img alt="../_images/05-neutral-atom-simulator-worked-solution_21_1.png" src="../_images/05-neutral-atom-simulator-worked-solution_21_1.png" />
<img alt="../_images/05-neutral-atom-simulator-worked-solution_21_2.png" src="../_images/05-neutral-atom-simulator-worked-solution_21_2.png" />
</div>
</div>
</section>
<section id="example-7-prepare-a-bell-state">
<h3>Example 7: Prepare a Bell state<a class="headerlink" href="#example-7-prepare-a-bell-state" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example 7: Prepare a Bell state</span>

<span class="n">atoms</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)]</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">NeutralAtomCircuit</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>

<span class="n">circuit</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;00&quot;</span><span class="p">,</span> <span class="n">step_rate</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Show one Bloch sphere with initial and final states and</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Duration of circuit (t):&quot;</span><span class="p">,</span> <span class="n">circuit</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of pulses:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">pulses</span><span class="p">))</span>
<span class="n">computational_basis_blochs</span><span class="p">([</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
<span class="n">computational_basis_blochs</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Duration of circuit (t): 9
Number of pulses: 9
</pre></div>
</div>
<img alt="../_images/05-neutral-atom-simulator-worked-solution_23_1.png" src="../_images/05-neutral-atom-simulator-worked-solution_23_1.png" />
<img alt="../_images/05-neutral-atom-simulator-worked-solution_23_2.png" src="../_images/05-neutral-atom-simulator-worked-solution_23_2.png" />
</div>
</div>
<p>The fully entangled state appears as two completely mixed states that are represented by the arrow heads at the centre of the Bloch sphere. Let’s check that the final state really is the expected Bell state and not some other state that has the same reduced density matrix probabilities but a different relative phase.</p>
<p>Note: We use <code class="docutils literal notranslate"><span class="pre">.tidyup(atol=1e-3)</span></code> to hide the small but non-zero coefficients. This makes it easier to see the large coefficients, but you should also look at the coefficients without <code class="docutils literal notranslate"><span class="pre">.tidyup</span></code> to see what magnitude they are. The <code class="docutils literal notranslate"><span class="pre">atol=1e-3</span></code> hides all coefficients less than <code class="docutils literal notranslate"><span class="pre">1e-3</span></code>.</p>
<p>To understand what the coefficients on the final state mean, remember that the first coefficient is for the basis state <code class="docutils literal notranslate"><span class="pre">|aa&gt;</span></code>, the second for <code class="docutils literal notranslate"><span class="pre">|ab&gt;</span></code>, the third for <code class="docutils literal notranslate"><span class="pre">|ar&gt;</span></code>, and then remainder for <code class="docutils literal notranslate"><span class="pre">|ba&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">|bb&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">|br&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">|ra&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">|rb&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">|rr&gt;</span></code>, in order.</p>
<p>The Bell state is <code class="docutils literal notranslate"><span class="pre">|aa&gt;</span> <span class="pre">+</span> <span class="pre">|bb&gt;</span></code> so we expect the first and fifth coefficients to be <span class="math notranslate nohighlight">\(\frac{1}{\sqrt{2}}\)</span> and the remaining coefficients to be small.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">tidyup</span><span class="p">(</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}Quantum object: dims = [[3, 3], [1, 1]], shape = (9, 1), type = ket $ \\ \left(\begin{matrix}-0.707j\\0.0\\0.0\\0.0\\-0.707j\\0.0\\0.0\\0.0\\0.0\\\end{matrix}\right)$\end{split}\]</div>
</div>
</div>
<p>And here are the reduce density matrices for the two qubits:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ptrace</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">tidyup</span><span class="p">(</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}Quantum object: dims = [[3], [3]], shape = (3, 3), type = oper, isherm = True $ \\ \left(\begin{matrix}0.500 &amp; 0.0 &amp; 0.0\\0.0 &amp; 0.500 &amp; 0.0\\0.0 &amp; 0.0 &amp; 0.0\\\end{matrix}\right)$\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ptrace</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tidyup</span><span class="p">(</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}Quantum object: dims = [[3], [3]], shape = (3, 3), type = oper, isherm = True $ \\ \left(\begin{matrix}0.500 &amp; 0.0 &amp; 0.0\\0.0 &amp; 0.500 &amp; 0.0\\0.0 &amp; 0.0 &amp; 0.0\\\end{matrix}\right)$\end{split}\]</div>
</div>
</div>
<p>Without the <code class="docutils literal notranslate"><span class="pre">.tidyup</span></code> applied, you can see all the smalller entries in the resulting state. These come from small numerical errors in determining the evolution of the system:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}Quantum object: dims = [[3, 3], [1, 1]], shape = (9, 1), type = ket $ \\ \left(\begin{matrix}(4.632\times10^{-05}-0.707j)\\(4.564\times10^{-05}+2.007\times10^{-06}j)\\(2.038\times10^{-09}-7.259\times10^{-09}j)\\(2.030\times10^{-06}+2.091\times10^{-06}j)\\(-2.706\times10^{-06}-0.707j)\\-7.396\times10^{-08}j\\(3.474\times10^{-07}+1.646\times10^{-11}j)\\(-2.196\times10^{-06}+1.170\times10^{-11}j)\\(-1.354\times10^{-04}-6.107\times10^{-05}j)\\\end{matrix}\right)$\end{split}\]</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./capstone"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="04-neutral-atom-simulator-exploration.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">04: Neutral Atom Simulator Class (Exploration)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../tutorials/00-qutip-intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">00: Introduction to QuTiP</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Simon Cross<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>